+++
date = "2018-07-21"
title = "CVE-2018-14430 WordPress Plugin Multi Step Form <= 1.2.5 - MÃºltiples Cross Site Scripting Reflejados"
author = "Javier Olmedo"
toc = false
+++

Durante otra de mis auditorias a plugins paraÂ [WordPress](https://es.wordpress.org/), he descubierto varias vulnerabilidades del tipoÂ [Cross Site Scripting Reflejado (XSS)](https://www.owasp.org/index.php/Cross-site_Scripting_\(XSS\))Â en el pluginÂ [Multi Step Form <= 1.2.5](https://es.wordpress.org/plugins/multi-step-form/), desarrollado porÂ [Mondula GmbH](https://mondula.com/). Esta vulnerabilidad ya fue reportada y ha sido asociada alÂ [CVE-2018-14430](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-14430).

## WordPress Plugin CVE-2018-14430

### Multi Step Form <= 1.2.5 â€“ MÃºltiples Cross Site Scripting Reflejados

[![/images/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados_001.png](/images/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados_001.png)](/images/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados_001.png)

Multi Step Form es un plugin para WordPress que nos permite crear formularios del tipo Drag & Drop (arrastrar y soltar) de forma rÃ¡pida e intuitiva con aspecto agradable. Los formularios se pueden incrustar en cualquier pÃ¡gina o publicaciÃ³n con cÃ³digos abreviados.

- ðŸ“…Â Vulnerabilidad descubierta porÂ [Javier Olmedo](https://twitter.com/JJavierOlmedo)Â elÂ **15/06/2018**
- ðŸ’£ Publicada elÂ **20/07/2018**
- ðŸ›Â [CVE-2018-14430](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-14430)
- ðŸ”—Â Link del softwareÂ [Multi Step Form](https://es.wordpress.org/plugins/multi-step-form/)
- ðŸžÂ VersiÃ³n vulnerable <=Â **1.2.5**
- ðŸ“¥ Instalaciones activasÂ **+6,000**

## Vector de ataque / Criticidad de la explotaciÃ³n

### CRITICIDAD -Â ðŸ”´ ALTA ðŸ”´

A travÃ©s de las vulnerabilidades Cross Site Scripting Reflejadas (XSS), un atacante podrÃ­aÂ **inyectar cÃ³digo javascript malicioso**Â en el navegador de la vÃ­ctima con el objetivo deÂ **robar informaciÃ³n delicada, realizar acciones sin el consentimiento del usuario legÃ­timo, secuestrar sesiones de usuario**Â o, incluso, llegar aÂ **comprometer todo el sistema**Â si la versiÃ³n del navegador tiene otras vulnerabilidades crÃ­ticas asociadas.

## ParÃ¡metros vulnerables

Los siguientes parÃ¡metros, son vulnerables a ataques XSS Reflejados en la funciÃ³nÂ `fw_send_data`:

[![/images/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados_002.png](/images/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados_002.png)](/images/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados_002.png)

```txt
fw_data[id][1]
fw_data[id][2]
fw_data[id][3]
fw_data[id][4]
email
```

Puede explotarse con el siguiente payload:

```txt
ðŸ’‰ <script>alert('PoC CVE-2018-14430')</script>
```

## Prueba de concepto (PoC)

[![/images/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados_003.gif](/images/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados_003.gif)](/images/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados_003.gif)

## Timeline

- **15/06/2018**Â Informo al desarrollador de la vulnerabilidad (sin contestaciÃ³n) ðŸ˜¥
- **27/06/2018**Â Vuelvo a informar la vulnerabilidad por segunda vez (tambiÃ©n sin contestaciÃ³n) ðŸ˜­
- **19/07/2018**Â Solicito CVE
- **20/07/2018**Â Hago pÃºblica la vulnerabilidad

## Referencias

- CCN CERT â€“Â [https://www.ccn-cert.cni.es/component/vulnerabilidades/view/24249.html](https://www.ccn-cert.cni.es/component/vulnerabilidades/view/24249.html)
- CVE-MITRE â€“Â [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-14430](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-14430)
- CVE Details â€“Â [https://www.cvedetails.com/cve/CVE-2018-14430/](https://www.cvedetails.com/cve/CVE-2018-14430/)
- NIST â€“Â [https://nvd.nist.gov/vuln/detail/CVE-2018-14430](https://nvd.nist.gov/vuln/detail/CVE-2018-14430)
- WPScan Vulnerability Database â€“Â [https://wpvulndb.com/vulnerabilities/9106](https://wpvulndb.com/vulnerabilities/9106)
- CX Security â€“Â [https://cxsecurity.com/cveshow/CVE-2018-14430/](https://cxsecurity.com/cveshow/CVE-2018-14430/)[](https://cxsecurity.com/cveshow/CVE-2018-13832/)
- Packet Storm â€“Â [https://packetstormsecurity.com/files/148617/WordPress-All-In-One-Favicon-4.6-Cross-Site-Scripting.html](https://packetstormsecurity.com/files/148617/WordPress-All-In-One-Favicon-4.6-Cross-Site-Scripting.html)

Un saludo a todos!!Â ðŸ‘‹