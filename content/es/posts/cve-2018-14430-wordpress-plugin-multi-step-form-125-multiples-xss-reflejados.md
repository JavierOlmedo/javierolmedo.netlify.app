+++
date = "2018-07-21"
title = "CVE-2018-14430 WordPress Plugin Multi Step Form <= 1.2.5 - Múltiples Cross Site Scripting Reflejados"
author = "Javier Olmedo"
toc = false
+++

Durante otra de mis auditorias a plugins para [WordPress](https://es.wordpress.org/), he descubierto varias vulnerabilidades del tipo [Cross Site Scripting Reflejado (XSS)](https://www.owasp.org/index.php/Cross-site_Scripting_\(XSS\)) en el plugin [Multi Step Form <= 1.2.5](https://es.wordpress.org/plugins/multi-step-form/), desarrollado por [Mondula GmbH](https://mondula.com/). Esta vulnerabilidad ya fue reportada y ha sido asociada al [CVE-2018-14430](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-14430).

## WordPress Plugin CVE-2018-14430

### Multi Step Form <= 1.2.5 – Múltiples Cross Site Scripting Reflejados

[![/images/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados_001.png](/images/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados_001.png)](/images/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados_001.png)

Multi Step Form es un plugin para WordPress que nos permite crear formularios del tipo Drag & Drop (arrastrar y soltar) de forma rápida e intuitiva con aspecto agradable. Los formularios se pueden incrustar en cualquier página o publicación con códigos abreviados.

- 📅 Vulnerabilidad descubierta por [Javier Olmedo](https://twitter.com/JJavierOlmedo) el **15/06/2018**
- 💣 Publicada el **20/07/2018**
- 🐛 [CVE-2018-14430](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-14430)
- 🔗 Link del software [Multi Step Form](https://es.wordpress.org/plugins/multi-step-form/)
- 🐞 Versión vulnerable <= **1.2.5**
- 📥 Instalaciones activas **+6,000**

## Vector de ataque / Criticidad de la explotación

### CRITICIDAD - 🔴 ALTA 🔴

A través de las vulnerabilidades Cross Site Scripting Reflejadas (XSS), un atacante podría **inyectar código javascript malicioso** en el navegador de la víctima con el objetivo de **robar información delicada, realizar acciones sin el consentimiento del usuario legítimo, secuestrar sesiones de usuario** o, incluso, llegar a **comprometer todo el sistema** si la versión del navegador tiene otras vulnerabilidades críticas asociadas.

## Parámetros vulnerables

Los siguientes parámetros, son vulnerables a ataques XSS Reflejados en la función `fw_send_data`:

[![/images/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados_002.png](/images/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados_002.png)](/images/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados_002.png)

```txt
fw_data[id][1]
fw_data[id][2]
fw_data[id][3]
fw_data[id][4]
email
```

Puede explotarse con el siguiente payload:

```txt
💉 <script>alert('PoC CVE-2018-14430')</script>
```

## Prueba de concepto (PoC)

[![/images/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados_003.gif](/images/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados_003.gif)](/images/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados/cve-2018-14430-wordpress-plugin-multi-step-form-125-multiples-xss-reflejados_003.gif)

## Timeline

- **15/06/2018** Informo al desarrollador de la vulnerabilidad (sin contestación) 😥
- **27/06/2018** Vuelvo a informar la vulnerabilidad por segunda vez (también sin contestación) 😭
- **19/07/2018** Solicito CVE
- **20/07/2018** Hago pública la vulnerabilidad

## Referencias

- CCN CERT – [https://www.ccn-cert.cni.es/component/vulnerabilidades/view/24249.html](https://www.ccn-cert.cni.es/component/vulnerabilidades/view/24249.html)
- CVE-MITRE – [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-14430](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-14430)
- CVE Details – [https://www.cvedetails.com/cve/CVE-2018-14430/](https://www.cvedetails.com/cve/CVE-2018-14430/)
- NIST – [https://nvd.nist.gov/vuln/detail/CVE-2018-14430](https://nvd.nist.gov/vuln/detail/CVE-2018-14430)
- WPScan Vulnerability Database – [https://wpvulndb.com/vulnerabilities/9106](https://wpvulndb.com/vulnerabilities/9106)
- CX Security – [https://cxsecurity.com/cveshow/CVE-2018-14430/](https://cxsecurity.com/cveshow/CVE-2018-14430/)[](https://cxsecurity.com/cveshow/CVE-2018-13832/)
- Packet Storm – [https://packetstormsecurity.com/files/148617/WordPress-All-In-One-Favicon-4.6-Cross-Site-Scripting.html](https://packetstormsecurity.com/files/148617/WordPress-All-In-One-Favicon-4.6-Cross-Site-Scripting.html)

Un saludo a todos!! 👋