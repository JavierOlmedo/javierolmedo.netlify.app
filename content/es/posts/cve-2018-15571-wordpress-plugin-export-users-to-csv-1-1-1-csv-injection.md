+++
date = "2018-08-24"
title = "CVE-2018-15571 WordPress Plugin Export Users to CSV 1.1.1 - CSV Injection"
author = "Javier Olmedo"
toc = false
+++

Buenas a todos de nuevo, volviendo de las vacaciones ğŸ–ï¸,Â [MITRE](https://cve.mitre.org/)Â me ha asignado otro CVE para pluginsÂ [WordPress](https://es.wordpress.org/), esta vez, he descubierto una vulnerabilidad de ejecuciÃ³n remota de cÃ³digo a travÃ©s deÂ [inyecciÃ³n CSV](https://www.owasp.org/index.php/CSV_Injection)Â en el pluginÂ [Export Users to CSV - 1.1.1](https://wordpress.org/plugins/export-users-to-csv/), desarrollado porÂ [Matt Cromwell](https://www.mattcromwell.com/products/export-users-to-csv). Esta vulnerabilidad ya fue reportada, no ha sido reconocida por el autor y ha sido asociada alÂ [CVE-2018-15571](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2018-15571).

## WordPress Plugin CVE-2018-15571

### Export Users to CSV - 1.1.1 - InyecciÃ³n CSV

[![/images/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection_001.png](/images/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection_001.png)](/images/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection_001.png)

Export Users to CSV es un plugin para WordPress que nos permite exportar datos de usuarios y metadatos. Incluso puede exportar los usuarios por rol y por rango de fechas de registro.

- ğŸ“…Â Vulnerabilidad descubierta porÂ [Javier Olmedo](https://twitter.com/JJavierOlmedo)Â elÂ **24/07/2018**
- ğŸ’£ Publicada elÂ **24/08/2018**
- ğŸ›Â [CVE-2018-15571](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15571)
- ğŸ”—Â Link del softwareÂ [Export Users to CSV](https://wordpress.org/plugins/export-users-to-csv/)
- ğŸÂ VersiÃ³n vulnerable =Â **1.1.1 y posiblemente anteriores**
- ğŸ“¥ Instalaciones activasÂ **+20,000**

## Vector de ataque / Criticidad de la explotaciÃ³n

### CRITICIDAD â€“Â ğŸ”´ ALTA ğŸ”´

A travÃ©s de las vulnerabilidades deÂ [inyecciÃ³n CSV,](https://www.owasp.org/index.php/CSV_Injection)Â un atacante podrÃ­aÂ **ejecutar cÃ³digo remoto en la mÃ¡quina del administrador**Â con el objetivo deÂ **secuestrar la mÃ¡quina**Â para filtrar datos confidenciales o utilizarla para otros ataques dentro de su red local (pivoting).

## ParÃ¡metros vulnerables

La inyecciÃ³n CSV, tambiÃ©n conocida como inyecciÃ³n de fÃ³rmula, ocurre cuando los sitios webÂ **incrustan datos que no son de confianza dentro de los archivos CSV que generan**, por lo tanto, no se puede decir que existen parÃ¡metros vulnerables, sino que, existe una mala formaciÃ³n a la hora de generar el archivo CSV ya que el software con el cual se abra el documento, interpretarÃ¡ formulas en las celdas que comiencen conÂ `=`, `@`, `-` o `+`.Â Debemos de asegurarnos que a la hora de generar los documentos ninguno comience con los caracteres anteriores.

## Prueba de concepto (PoC)

1.Â Un usuario, aÃ±ade el payloadÂ `=SUM(1+1)*cmd|' /C calc'!A0`Â en cualquier campo de su perfil, por ejemplo, en la biografÃ­a.

[![/images/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection_002.png](/images/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection_002.png)](/images/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection_002.png)

2.Â El usuario administrador, exportarÃ¡ los datos de los usuarios a un CSV.

[![/images/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection_003.gif](/images/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection_003.gif)](/images/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection_003.gif)

3.Â Cuando el administrador abra el documento CSV generado anteriormente, el payload se ejecutarÃ¡ y la calculadora se abrirÃ¡.

[![/images/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection_004.gif](/images/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection_004.gif)](/images/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection/cve-2018-15571-wordpress-plugin-export-users-to-csv-1-1-1-csv-injection_004.gif)

Puede explotarse con los siguientes payloads:

```txt
ğŸ’‰ =SUM(1+1)*cmd|' /C calc'!A0  
ğŸ’‰ +SUM(1+1)*cmd|' /C calc'!A0  
ğŸ’‰ -SUM(1+1)*cmd|' /C calc'!A0  
ğŸ’‰ @SUM(1+1)*cmd|' /C calc'!A0
```

## Timeline

- **24/07/2018**Â Descubrimiento
- **25/07/2018**Â Informo al desarrollador
- **25/07/2018**Â El desarrollador no reconoce la vulnerabilidad ğŸ˜¥
- **07/08/2018**Â Solicito CVE
- **16/08/2018**Â MITRE me asigna el CVE-2018-15571
- **24/08/2018**Â Hago pÃºblica la vulnerabilidad

## Referencias

- CVE-MITRE -Â [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15571](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15571)
- Exploit-DB -Â [https://www.exploit-db.com/exploits/45206/](https://www.exploit-db.com/exploits/45206/)
- 0Day Today -Â [https://0day.today/exploit/30899](https://0day.today/exploit/30899)

Un saludo a todos!!Â ğŸ‘‹