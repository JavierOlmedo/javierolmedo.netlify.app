+++
date = "2018-08-26"
title = "CVE-2018-15873 Sentrifugo HRMS 3.2 - Blind SQL Injection"
author = "Javier Olmedo"
toc = false
+++

Esta entrada tiene como objetivo hacer pública la vulnerabilidad [Blind SQL Injection](https://www.owasp.org/index.php/Blind_SQL_Injection) descubierta en el software [Sentrifugo HRMS 3.2](http://www.sentrifugo.com/download), la vulnerabilidad ha sido asociada al [CVE-2018-15873](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2018-15873).

## Sentrifugo HRMS 3.2 - CVE-2018-15873

### Blind SQL Injection

[![/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_001.png](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_001.png)](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_001.png)

Sentrifugo es un software open source que facilita la **administración de recursos humanos** en las organizaciones. Está **repleto de módulos** esenciales como evaluación, gestión del tiempo, gestión de licencias, gestión de empleados, análisis, contratación, verificación de antecedentes, servicio técnico y mucho más. Permite a los empleados **contribuir de manera efectiva y productiva** a los objetivos de la organización.

- 📅 Vulnerabilidad descubierta por [Javier Olmedo](https://twitter.com/JJavierOlmedo) el **30/07/2018**
- 💣 Publicada el **26/08/2018**
- 🐛 [CVE-2018-15873](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15873)
- 🔗 Link del software [Sentrifugo HRMS](http://www.sentrifugo.com/download)
- 🐞 Versión vulnerable = **3.2 y posiblemente anteriores**

## Vector de ataque / Criticidad de la explotación

### CRITICIDAD - 🟣 CRÍTICA 🟣

A través de las vulnerabilidades [Blind SQL Injection](https://www.owasp.org/index.php/Blind_SQL_Injection), un usuario malintencionado podría **leer información de la base de datos que utiliza la aplicación** en base a preguntas de verdadero o falso con el objetivo de **extraer información sensible o confidencial** como contraseñas o datos personales de otros usuarios.

## Parámetros vulnerables

El parámetro `deptid`, es vulnerable a **Blind SQL Injectión** mediante petición **POST** en el recurso `/index.php/servicedeskconf/getemployees/format/html`

**💉 Payload**

```txt
bunitid=0&deptid=(SELECT (CASE WHEN (5610=5610) THEN 5610 ELSE 5610*(SELECT 5610 FROM INFORMATION_SCHEMA.PLUGINS) END))&reqfor=2**
```

📷 **Captura de pantalla de SQLmap lanzando el comando**

```bash
sqlmap -r poc.req -p deptid --dbms=MySQL --dbs
```

[![/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_002.png](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_002.png)](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_002.png)

## Prueba de concepto (PoC)

1.  Si añadimos el caracter `'` en el parámetro `deptid` obtenemos un **código 500** (error en la aplicación)

1.1 Petición

[![/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_003.png](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_003.png)](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_003.png)

1.2 Respuesta

[![/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_004.png](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_004.png)](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_004.png)

2. En cambio, al añadir dos `'`, obtenemos un **código 200** **OK**

2.1 Petición

[![/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_005.png](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_005.png)](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_005.png)

2.2 Respuesta

[![/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_006.png](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_006.png)](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_006.png)

## Timeline

- **30/07/2018** Descubrimiento
- **30/07/2018** Informo al desarrollador
- **02/08/2018** Abro issue en GitHub
- **25/08/2018** Solicito CVE
- **25/08/2018** MITRE me asigna el CVE-2018-15873
- **26/08/2018** Hago pública la vulnerabilidad

## Referencias

- CVE-MITRE - [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15873](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15873)

Un saludo a todos!! 👋