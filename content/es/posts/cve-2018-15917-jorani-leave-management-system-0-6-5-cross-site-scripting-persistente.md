+++
date = "2018-09-01"
title = "CVE-2018-15917 Jorani Leave Management System 0.6.5 - Cross-Site Scripting Persistente"
author = "Javier Olmedo"
toc = false
+++

Esta entrada tiene como objetivo hacer p煤blica la vulnerabilidad[Cross-Site Scripting Persistente](https://www.owasp.org/index.php/Cross-site_Scripting_\(XSS\))descubierta en el software[Jorani Leave Management System 0.6.5](https://jorani.org/download.html), la vulnerabilidad ha sido asociada al[CVE-2018-15917](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2018-15917).

## JoraniCVE-2018-15917

### Jorani Leave Management System 0.6.5 - Cross-Site Scripting Persistente

[![/images/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente_001.jpg](/images/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente_001.jpg)](/images/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente_001.jpg)

Jorani es un sistema de administraci贸n de licencias desarrollado en PHP / MySQL bajo una licencia AGPL v3, est谩 dise帽ado para proporcionar solicitud de flujos de trabajo simples y tiempo extra para organizaciones peque帽as.

- Vulnerabilidad descubierta por[Javier Olmedo](https://twitter.com/JJavierOlmedo)el**02/08/2018**
-  Publicada el**01/09/2018**
- [CVE-2018-15917](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15917)
- Link del software[Jorani Leave Management System](https://jorani.org/download.html)
- Versi贸n vulnerable =**0.6.5 y posiblemente anteriores**

## Vector de ataque / Criticidad de la explotaci贸n

### CRITICIDAD - ALTA 

A trav茅s de las vulnerabilidades Cross Site Scripting Reflejadas (XSS), un atacante podr铆a**inyectar c贸digo javascript malicioso**en el navegador de la v铆ctima con el objetivo de**robar informaci贸n sensible, realizar acciones sin el consentimiento del usuario leg铆timo, secuestrar sesiones de usuario**o, incluso, llegar a**comprometer todo el sistema**si la versi贸n del navegador tiene otras vulnerabilidades cr铆ticas asociadas.

## Par谩metro vulnerable

El par谩metro`language`es vulnerable a ataques**Cross-Site Scripting (XSS) Persistentes**a trav茅s de una petici贸n**GET**en la cu谩l los valores quedan almacenadosen la sesi贸n del usuario:

```txt
localhost/session/language?last_page=session%2Flogin&language=en%22%3E%3Cscript%3Ealert(%27PoC%20CVE-2018-15917%27)%3C%2Fscript%3E&login=&CipheredValue=
```

**Petici贸n**

[![/images/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente_002.png](/images/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente_002.png)](/images/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente_002.png)

**Respuesta**

[![/images/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente_003.png](/images/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente_003.png)](/images/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente_003.png)

**Alerta en el navegador**

[![/images/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente_004.png](/images/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente_004.png)](/images/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente_004.png)

Puede explotarse con el siguiente payload:

```txt
en"><script>alert('PoC CVE-2018-15917')</script>
```

## Prueba de concepto (PoC)

[![/images/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente_005.gif](/images/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente_005.gif)](/images/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente/cve-2018-15917-jorani-leave-management-system-0-6-5-cross-site-scripting-persistente_005.gif)

## Timeline

- **02/08/2018**Descubrimiento de la vulnerabilidad
- **02/08/2018**Creo issue en GitHub del proyecto
- **03/08/2018**El desarrollador invalida y cierra el issue 
- **27/08/2018**Solicito CVE
- **28/08/2018**Asignaci贸n de CVE-2018-15917 por MITRE
- **01/09/2018**Hago p煤blica la vulnerabilidad

## Referencias

- CVE-MITRE -[https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15917](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15917)

Un saludo a todos!!