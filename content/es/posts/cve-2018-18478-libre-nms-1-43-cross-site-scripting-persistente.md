+++
date = "2018-10-19"
title = "CVE-2018-18478 Libre NMS 1.43 - Cross-Site Scripting Persistente"
author = "Javier Olmedo"
toc = false
+++

Esta entrada tiene como objetivo hacer pública la vulnerabilidad [Cross-Site Scripting Persistente](https://www.owasp.org/index.php/Cross-site_Scripting_\(XSS\)) descubierta en el software [Libre NMS 1.43](https://github.com/librenms/librenms/releases/tag/1.43), la vulnerabilidad ha sido asociada al [CVE-2018-18478](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2018-18478).

## Libre NMS - CVE-2018-18478

### Libre NMS 1.43 – Cross-Site Scripting Persistente

[![/images/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente_001.png](/images/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente_001.png)](/images/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente_001.png)

Libre Network Monitoring System, es un software utilizado para monitoreo de red basado en PHP / MySQL / SNMP que incluye el soporte para una amplia gama de hardware de red y sistemas operativos que incluyen Cisco, Linux, FreeBSD, Juniper, Brocade, Foundry, HP y muchos más.

- 📅 Vulnerabilidad descubierta por [Javier Olmedo](https://twitter.com/JJavierOlmedo) el **08/09/2018**
- 💣 Publicada el **19/10/2018**
- 🐛 [CVE-2018-15917](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18478)
- 🔗 Link del software [Libre NMS](https://github.com/librenms/librenms/releases/tag/1.43)
- 🐞 Versión vulnerable = **1.43 y posiblemente anteriores**

## Vector de ataque / Criticidad de la explotación

### CRITICIDAD - 🔴 ALTA 🔴

A través de las vulnerabilidades Cross Site Scripting Persistentes (XSS), un atacante podría **inyectar código javascript malicioso** en el navegador de la víctima con el objetivo de **robar información sensible, realizar acciones sin el consentimiento del usuario legítimo, secuestrar sesiones de usuario** o, incluso, llegar a **comprometer todo el sistema** si la versión del navegador tiene otras vulnerabilidades críticas asociadas.

## **Parámetro vulnerable**

El parámetro `dashboard_name` es vulnerable a ataques **Cross-Site Scripting (XSS) Persistentes** en los recursos `html/includes/forms/add-dashboard.inc.php`, `html/includes/forms/delete-dashboard.inc.php, y `html/includes/forms/edit-dashboard.inc.php`.

Puede explotarse con el siguiente payload:

```txt
💉 <script>alert('PoC CVE-2018-18478')</script>
```

## Prueba de concepto (PoC)

[![/images/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente_002.gif](/images/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente_002.gif)](/images/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente_002.gif)

## Más información

- [https://github.com/librenms/librenms/issues/9170](https://github.com/librenms/librenms/issues/9170) 
- [https://github.com/librenms/librenms/pull/9171](https://github.com/librenms/librenms/pull/9171)
- [https://github.com/librenms/librenms/releases/tag/1.44](https://github.com/librenms/librenms/releases/tag/1.44)

## Timeline

- **08/09/2018** Descubrimiento de la vulnerabilidad
- **08/09/2018** Creo issue en el proyecto de GitHub
- **08/09/2018** El desarrollador marca la vulnerabiliad como pendiente de parcheo y cierra el issue
- **16/10/2018** La vulnerabilidad queda solucionada
- **18/08/2018** Solicito CVE
- **18/08/2018** Asignación de CVE-2018-18478 por MITRE
- **19/10/2018** Hago pública la vulnerabilidad

## Referencias

- CVE-MITRE – [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18478](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18478)

Un saludo a todos!! 👋