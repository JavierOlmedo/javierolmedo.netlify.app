+++
date = "2018-10-19"
title = "CVE-2018-18478 Libre NMS 1.43 - Cross-Site Scripting Persistente"
author = "Javier Olmedo"
toc = false
+++

Esta entrada tiene como objetivo hacer pÃºblica la vulnerabilidadÂ [Cross-Site Scripting Persistente](https://www.owasp.org/index.php/Cross-site_Scripting_\(XSS\))Â descubierta en el softwareÂ [Libre NMS 1.43](https://github.com/librenms/librenms/releases/tag/1.43), la vulnerabilidad ha sido asociada alÂ [CVE-2018-18478](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2018-18478).

## Libre NMS -Â CVE-2018-18478

### Libre NMS 1.43 â€“ Cross-Site Scripting Persistente

[![/images/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente_001.png](/images/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente_001.png)](/images/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente_001.png)

Libre Network Monitoring System, es un software utilizado para monitoreo de red basado en PHP / MySQL / SNMP que incluye el soporte para una amplia gama de hardware de red y sistemas operativos que incluyen Cisco, Linux, FreeBSD, Juniper, Brocade, Foundry, HP y muchos mÃ¡s.

- ğŸ“…Â Vulnerabilidad descubierta porÂ [Javier Olmedo](https://twitter.com/JJavierOlmedo)Â elÂ **08/09/2018**
- ğŸ’£ Publicada elÂ **19/10/2018**
- ğŸ›Â [CVE-2018-15917](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18478)
- ğŸ”—Â Link del softwareÂ [Libre NMS](https://github.com/librenms/librenms/releases/tag/1.43)
- ğŸÂ VersiÃ³n vulnerable =Â **1.43 y posiblemente anteriores**

## Vector de ataque / Criticidad de la explotaciÃ³n

### CRITICIDAD -Â ğŸ”´ ALTA ğŸ”´

A travÃ©s de las vulnerabilidades Cross Site Scripting Persistentes (XSS), un atacante podrÃ­aÂ **inyectar cÃ³digo javascript malicioso**Â en el navegador de la vÃ­ctima con el objetivo deÂ **robar informaciÃ³n sensible, realizar acciones sin el consentimiento del usuario legÃ­timo, secuestrar sesiones de usuario**Â o, incluso, llegar aÂ **comprometer todo el sistema**Â si la versiÃ³n del navegador tiene otras vulnerabilidades crÃ­ticas asociadas.

## **ParÃ¡metro vulnerable**

El parÃ¡metroÂ `dashboard_name`Â es vulnerable a ataquesÂ **Cross-Site Scripting (XSS) Persistentes**Â en los recursosÂ `html/includes/forms/add-dashboard.inc.php`, `html/includes/forms/delete-dashboard.inc.php, y `html/includes/forms/edit-dashboard.inc.php`.

Puede explotarse con el siguiente payload:

```txt
ğŸ’‰Â <script>alert('PoC CVE-2018-18478')</script>
```

## Prueba de concepto (PoC)

[![/images/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente_002.gif](/images/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente_002.gif)](/images/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente/cve-2018-18478-libre-nms-1-43-cross-site-scripting-persistente_002.gif)

## MÃ¡s informaciÃ³n

- [https://github.com/librenms/librenms/issues/9170](https://github.com/librenms/librenms/issues/9170) 
- [https://github.com/librenms/librenms/pull/9171](https://github.com/librenms/librenms/pull/9171)
- [https://github.com/librenms/librenms/releases/tag/1.44](https://github.com/librenms/librenms/releases/tag/1.44)

## Timeline

- **08/09/2018**Â Descubrimiento de la vulnerabilidad
- **08/09/2018**Â Creo issue en el proyecto de GitHub
- **08/09/2018**Â El desarrollador marca la vulnerabiliad como pendiente de parcheo y cierra el issue
- **16/10/2018**Â La vulnerabilidad queda solucionada
- **18/08/2018**Â Solicito CVE
- **18/08/2018**Â AsignaciÃ³n de CVE-2018-18478 por MITRE
- **19/10/2018**Â Hago pÃºblica la vulnerabilidad

## Referencias

- CVE-MITRE â€“Â [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18478](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18478)

Un saludo a todos!!Â ğŸ‘‹