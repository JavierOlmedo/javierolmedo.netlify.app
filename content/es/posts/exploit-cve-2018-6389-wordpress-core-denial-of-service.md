+++
date = "2018-03-08"
title = "Exploit CVE-2018-6389 - WordPress Core - Denial of Service"
author = "Javier Olmedo"
toc = false
+++

Últimamente estoy muy atento de las vulnerabilidades de los CMS y vengo a compartir con vosotros otro exploit que he desarrollado para la vulnerabilidad [CVE-2018-6389](https://www.certsi.es/alerta-temprana/vulnerabilidades/cve-2018-6389). Esta vulnerabilidad descubierta por [Barak Tawily](http://baraktawily.blogspot.com.es/), permite lanzar un [ataque de denegación de servicio (DOS)](https://es.wikipedia.org/wiki/Ataque_de_denegaci%C3%B3n_de_servicio) sobre las páginas webs desarrolladas con WordPress (se estima que **aproximadamente el 29% de todas las webs que existen actualmente** en el mundo están desarrolladas con este framework).

La vulnerabilidad, existe en el archivo `load-scripts.php` cuando recibe un parámetro llamado `load []`, este parámetro, es un array que está **destinado a proporcionar archivos JS a los usuarios**, por lo tanto, si lo solicitáramos muchas veces, generaríamos gran carga en el servidor de la aplicación, provocando así una caída del servicio.

[![/images/exploit-cve-2018-6389-wordpress-core-denial-of-service/exploit-cve-2018-6389-wordpress-core-denial-of-service_001.png](/images/exploit-cve-2018-6389-wordpress-core-denial-of-service/exploit-cve-2018-6389-wordpress-core-denial-of-service_001.png)](/images/exploit-cve-2018-6389-wordpress-core-denial-of-service/exploit-cve-2018-6389-wordpress-core-denial-of-service_001.png)

## WordPress CVE-2018-6389

### WordPress Core – 'load-scripts.php' Denial of Service <= 4.9.4

- 📅 Vulnerabilidad descubierta por [Barak Tawily](http://baraktawily.blogspot.com.es/) el **05/02/2018**
- 💣 Exploit desarrollado por [Javier Olmedo](https://twitter.com/JJavierOlmedo) el **03/03/2018**
- 🐛 [CVE-2018-6389](https://www.certsi.es/en/early-warning/vulnerabilities/cve-2018-6389)
- 🔗 Link del software  [WordPress](https://wordpress.org/)
- 🐞 Versión vulnerable <= **4.9.4 (Todas las versiones hasta la fecha)**

### ¿Cómo usar este exploit?

En primer lugar, **usa este exploit únicamente sobre sitios web administrados por ti o en los cuales tengas consentimiento** para realizar está comprobación, en mi caso, me he creado una web con [WordPress 4.9.4](https://wordpress.org/download/) en mi máquina local.

1. Clona [mi repositorio de GitHub](https://github.com/JavierOlmedo/wordpress-cve-2018-6389) en tu equipo

```bash
git clone https://github.com/JavierOlmedo/wordpress-cve-2018-6389.git
```

2. Cambiamos al directorio que hemos clonado

```bash
cd wordpress-cve-2018-6389
```

3. Cambiamos los permisos del archivo, añadiendo de ejecución

```bash
sudo chmod +x wordpress-cve-2018-6389.py
```

4. Lanzamos el ataque indicando el sitio a comprobar

```bash
python3 wordpress-cve-2018-6389.py -u <TARGET>
```

### Prueba de concepto

[![/images/exploit-cve-2018-6389-wordpress-core-denial-of-service/exploit-cve-2018-6389-wordpress-core-denial-of-service_002.gif](/images/exploit-cve-2018-6389-wordpress-core-denial-of-service/exploit-cve-2018-6389-wordpress-core-denial-of-service_002.gif)](/images/exploit-cve-2018-6389-wordpress-core-denial-of-service/exploit-cve-2018-6389-wordpress-core-denial-of-service_002.gif)

### Otros proyectos de GitHub

[![/images/exploit-cve-2018-6389-wordpress-core-denial-of-service/exploit-cve-2018-6389-wordpress-core-denial-of-service_003.png](/images/exploit-cve-2018-6389-wordpress-core-denial-of-service/exploit-cve-2018-6389-wordpress-core-denial-of-service_003.png)](/images/exploit-cve-2018-6389-wordpress-core-denial-of-service/exploit-cve-2018-6389-wordpress-core-denial-of-service_003.png)

https://github.com/JavierOlmedo

Un saludo a todos!! 👋