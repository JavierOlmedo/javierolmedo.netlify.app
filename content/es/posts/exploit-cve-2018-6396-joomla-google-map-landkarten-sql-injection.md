+++
date = "2018-03-04"
title = "Exploit CVE-2018-6396 - Joomla Google Map Landkarten SQL Injection"
author = "Javier Olmedo"
toc = false
+++

Hoy quería compartir con vosotros un [exploit](https://es.wikipedia.org/wiki/Exploit) que he desarrollado en Python para explotar una vulnerabilidad SQLi descubierta por [Ihsan Sencan](https://twitter.com/ihsansencan) en el componente [Google Map Landkarten](https://extensions.joomla.org/extensions/extension/maps-a-weather/maps-a-locations/google-map-landkarten/), esta vulnerabilidad tiene asociado el [CVE-2018-6396.](https://www.certsi.es/en/early-warning/vulnerabilities/cve-2018-6396)

## Joomla CVE-2018-6396

### Joomla! Component Google Map Landkarten <= 4.2.3 – SQL Injection

- 📅 Vulnerabilidad descubierta por [Ihsan Sencan](https://www.exploit-db.com/exploits/44113/) el **16/02/2018**
- 💣 Exploit desarrollado por [Javier Olmedo](https://twitter.com/JJavierOlmedo) el **03/03/2018**
- 🐛 [CVE-2018-6396](https://www.certsi.es/en/early-warning/vulnerabilities/cve-2018-6396)
- 🔗 Link del software  [Google Map Landkarten](https://extensions.joomla.org/extensions/extension/maps-a-weather/maps-a-locations/google-map-landkarten/)
- 🐞 Versión vulnerable <= **4.2.3**

### ¿Cómo usar este exploit?

En primer lugar, **usa este exploit únicamente sobre sitios web administrados por ti o en los cuales tengas consentimiento** para realizar está comprobación, en mi caso, me he creado una web con [Joomla 3.8.5](https://downloads.joomla.org/es/) en mi máquina local.

1. Clona [mi repositorio de GitHub](https://github.com/JavierOlmedo/joomla-cve-2018-6396) en tu equipo

```bash
git clone https://github.com/JavierOlmedo/joomla-cve-2018-6396.git
```

2. Cambiamos al directorio que hemos clonado

```bash
cd joomla-cve-2018-6396
```

3. Cambiamos los permisos del archivo, añadiendo de ejecución

```bash
sudo chmod +x joomla-cve-2018-6396.py
```

4. Lanzamos el ataque indicando el sitio a comprobar

```bash
python3 joomla-cve-2018-6396.py -u <TARGET>
```

Es necesario tener [sqlmap](http://sqlmap.org/) instalado para verificar la vulnerabilidad.

### Prueba de concepto

[![/images/exploit-cve-2018-6396-joomla-google-map-landkarten-sql-injection/exploit-cve-2018-6396-joomla-google-map-landkarten-sql-injection_001.gif](/images/exploit-cve-2018-6396-joomla-google-map-landkarten-sql-injection/exploit-cve-2018-6396-joomla-google-map-landkarten-sql-injection_001.gif)](/images/exploit-cve-2018-6396-joomla-google-map-landkarten-sql-injection/exploit-cve-2018-6396-joomla-google-map-landkarten-sql-injection_001.gif)

### Otros proyectos de GitHub

[![/images/exploit-cve-2018-6396-joomla-google-map-landkarten-sql-injection/exploit-cve-2018-6396-joomla-google-map-landkarten-sql-injection_002.png](/images/exploit-cve-2018-6396-joomla-google-map-landkarten-sql-injection/exploit-cve-2018-6396-joomla-google-map-landkarten-sql-injection_002.png)](/images/exploit-cve-2018-6396-joomla-google-map-landkarten-sql-injection/exploit-cve-2018-6396-joomla-google-map-landkarten-sql-injection_002.png)

https://github.com/JavierOlmedo

Un saludo a todos!! 👋